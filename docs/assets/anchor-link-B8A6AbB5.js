import{bi as C,aV as oe,b as z,j as B,Q as F,a5 as L,aD as re,l as E,r as S,m as se,d as N,aB as ce,o as U,w as V,p as le,q as T,t as _,A as g,e as h,J as ie,G as q,z as G,I as $,_ as X,N as ae,h as ue,X as fe,M as pe,aG as de,R as he,S as me}from"./index-BAGX0cd5.js";import{r as J,c as H}from"./raf-DGLd0U_J.js";function ve(e,n,s,o){const u=s-n;return e/=o/2,e<1?u/2*e*e*e+n:u/2*((e-=2)*e*e+2)+n}function ke(e,n,s,o,u){const m=Date.now();let f;const l=()=>{const p=Date.now()-m,k=ve(p>o?o:p,n,s,o);C(e)?e.scrollTo(window.pageXOffset,k):e.scrollTop=k,p<o?f=J(l):oe(u)&&u()};return l(),()=>{f&&H(f)}}const I=(e,n)=>C(n)?e.ownerDocument.documentElement:n,M=e=>C(e)?window.scrollY:e.scrollTop,P=e=>{let n=0,s=e;for(;s;)n+=s.offsetTop,s=s.offsetParent;return n},j=(e,n)=>Math.abs(P(e)-P(n)),ge=z({container:{type:L([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:L(String),default:"default"},direction:{type:L(String),default:"vertical"}}),ye={change:e=>B(e),click:(e,n)=>e instanceof MouseEvent&&(B(n)||F(n))},K=Symbol("anchor"),w=e=>{if(!re||e==="")return null;if(B(e))try{return document.querySelector(e)}catch{return null}return e};function Se(e){let n=0;const s=(...o)=>{n&&H(n),n=J(()=>{e(...o),n=0})};return s.cancel=()=>{H(n),n=0},s}const we=E({name:"ElAnchor"}),Te=E({...we,props:ge,emits:ye,setup(e,{expose:n,emit:s}){const o=e,u=S(""),m=S(null),f=S(null),l=S(),v={};let p=!1,k=0;const r=se("anchor"),y=N(()=>[r.b(),o.type==="underline"?r.m("underline"):"",r.m(o.direction)]),W=t=>{v[t.href]=t.el},Y=t=>{delete v[t]},x=t=>{u.value!==t&&(u.value=t,s("change",t))};let R=null;const Z=t=>{if(!l.value)return;const c=w(t);if(!c)return;R&&R(),p=!0;const i=I(c,l.value),a=j(c,i),d=i.scrollHeight-i.clientHeight,b=Math.min(a-o.offset,d);R=ke(l.value,k,b,o.duration,()=>{setTimeout(()=>{p=!1},20)})},A=t=>{t&&(x(t),Z(t))},ee=(t,c)=>{s("click",t,c),A(c)},D=Se(()=>{l.value&&(k=M(l.value));const t=te();p||F(t)||x(t)}),te=()=>{if(!l.value)return;const t=M(l.value),c=[];for(const i of Object.keys(v)){const a=w(i);if(!a)continue;const d=I(a,l.value),b=j(a,d);c.push({top:b-o.offset-o.bound,href:i})}c.sort((i,a)=>i.top-a.top);for(let i=0;i<c.length;i++){const a=c[i],d=c[i+1];if(i===0&&t===0)return"";if(a.top<=t&&(!d||d.top>t))return a.href}},O=()=>{const t=w(o.container);!t||C(t)?l.value=window:l.value=t};ce(l,"scroll",D);const ne=N(()=>{if(!m.value||!f.value||!u.value)return{};const t=v[u.value];if(!t)return{};const c=m.value.getBoundingClientRect(),i=f.value.getBoundingClientRect(),a=t.getBoundingClientRect();return o.direction==="horizontal"?{left:`${a.left-c.left}px`,width:`${a.width}px`,opacity:1}:{top:`${a.top-c.top+(a.height-i.height)/2}px`,opacity:1}});return U(()=>{O();const t=decodeURIComponent(window.location.hash);w(t)?A(t):D()}),V(()=>o.container,()=>{O()}),le(K,{ns:r,direction:o.direction,currentAnchor:u,addLink:W,removeLink:Y,handleClick:ee}),n({scrollTo:A}),(t,c)=>(T(),_("div",{ref_key:"anchorRef",ref:m,class:g(h(y))},[t.marker?(T(),_("div",{key:0,ref_key:"markerRef",ref:f,class:g(h(r).e("marker")),style:ie(h(ne))},null,6)):q("v-if",!0),G("div",{class:g(h(r).e("list"))},[$(t.$slots,"default")],2)],2))}});var _e=X(Te,[["__file","anchor.vue"]]);const Ce=z({title:String,href:String}),Ee=E({name:"ElAnchorLink"}),Re=E({...Ee,props:Ce,setup(e){const n=e,s=S(null),{ns:o,direction:u,currentAnchor:m,addLink:f,removeLink:l,handleClick:v}=ae(K),p=N(()=>[o.e("link"),o.is("active",m.value===n.href)]),k=r=>{v(r,n.href)};return V(()=>n.href,(r,y)=>{de(()=>{y&&l(y),r&&f({href:r,el:s.value})})}),U(()=>{const{href:r}=n;r&&f({href:r,el:s.value})}),ue(()=>{const{href:r}=n;r&&l(r)}),(r,y)=>(T(),_("div",{class:g(h(o).e("item"))},[G("a",{ref_key:"linkRef",ref:s,class:g(h(p)),href:r.href,onClick:k},[$(r.$slots,"default",{},()=>[fe(pe(r.title),1)])],10,["href"]),r.$slots["sub-link"]&&h(u)==="vertical"?(T(),_("div",{key:0,class:g(h(o).e("list"))},[$(r.$slots,"sub-link")],2)):q("v-if",!0)],2))}});var Q=X(Re,[["__file","anchor-link.vue"]]);const Le=he(_e,{AnchorLink:Q}),Be=me(Q);export{Be as E,Le as a};
