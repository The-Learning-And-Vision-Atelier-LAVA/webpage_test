import{H as N,a5 as S,X as L,m as g,M as oe,$ as B,an as re,t as P,q,z as le,a as R,O as _,F as k,E as v,e as ae,o as K,s as Q,w as E,I as X,T as se,v as ie,R as ce,B as ue,_ as fe,A as de,K as x,Q as Y,aF as he,bl as T,ae as ve,aP as pe}from"./index-vfCpJMGO.js";import{a as M,e as U}from"./raf-DNOUc5rR-BGvIQPP6.js";function me(e,n,l,o){const u=l-n;return e/=o/2,e<1?u/2*e*e*e+n:u/2*((e-=2)*e*e+2)+n}function ke(e,n,l,o,u){const p=Date.now();let f;const a=()=>{const d=Date.now()-p,h=me(d>o?o:d,n,l,o);T(e)?e.scrollTo(window.pageXOffset,h):e.scrollTop=h,d<o?f=U(a):pe(u)&&u()};return a(),()=>{f&&M(f)}}const H=(e,n)=>T(n)?e.ownerDocument.documentElement:n,I=e=>T(e)?window.scrollY:e.scrollTop,z=e=>{let n=0,l=e;for(;l;)n+=l.offsetTop,l=l.offsetParent;return n},F=(e,n)=>Math.abs(z(e)-z(n)),ye=N({container:{type:S([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:S(String),default:"default"},direction:{type:S(String),default:"vertical"}}),ge={change:e=>x(e),click:(e,n)=>e instanceof MouseEvent&&(x(n)||Y(n))},W=Symbol("anchor"),w=e=>{if(!he||e==="")return null;if(x(e))try{return document.querySelector(e)}catch{return null}return e};function be(e){let n=0;const l=(...o)=>{n&&M(n),n=U(()=>{e(...o),n=0})};return l.cancel=()=>{M(n),n=0},l}const we=L({name:"ElAnchor"}),Re=L({...we,props:ye,emits:ge,setup(e,{expose:n,emit:l}){const o=e,u=g(""),p=g(null),f=g(null),a=g(),d={};let h=!1,b=0;const r=oe("anchor"),y=B(()=>[r.b(),o.type==="underline"?r.m("underline"):"",r.m(o.direction)]),G=t=>{d[t.href]=t.el},J=t=>{delete d[t]},O=t=>{u.value!==t&&(u.value=t,l("change",t))};let $=null;const V=t=>{if(!a.value)return;const s=w(t);if(!s)return;$&&$(),h=!0;const i=H(s,a.value),c=F(s,i),m=i.scrollHeight-i.clientHeight,C=Math.min(c-o.offset,m);$=ke(a.value,b,C,o.duration,()=>{setTimeout(()=>{h=!1},20)})},A=t=>{t&&(O(t),V(t))},ee=(t,s)=>{l("click",t,s),A(s)},j=be(()=>{a.value&&(b=I(a.value));const t=te();h||Y(t)||O(t)}),te=()=>{if(!a.value)return;const t=I(a.value),s=[];for(const i of Object.keys(d)){const c=w(i);if(!c)continue;const m=H(c,a.value),C=F(c,m);s.push({top:C-o.offset-o.bound,href:i})}s.sort((i,c)=>i.top-c.top);for(let i=0;i<s.length;i++){const c=s[i],m=s[i+1];if(i===0&&t===0)return"";if(c.top<=t&&(!m||m.top>t))return c.href}},D=()=>{const t=w(o.container);!t||T(t)?a.value=window:a.value=t};re(a,"scroll",j);const ne=B(()=>{if(!p.value||!f.value||!u.value)return{};const t=d[u.value];if(!t)return{};const s=p.value.getBoundingClientRect(),i=f.value.getBoundingClientRect(),c=t.getBoundingClientRect();return o.direction==="horizontal"?{left:`${c.left-s.left}px`,width:`${c.width}px`,opacity:1}:{top:`${c.top-s.top+(c.height-i.height)/2}px`,opacity:1}});return P(()=>{D();const t=decodeURIComponent(window.location.hash);w(t)?A(t):j()}),q(()=>o.container,()=>{D()}),le(W,{ns:r,direction:o.direction,currentAnchor:u,addLink:G,removeLink:J,handleClick:ee}),n({scrollTo:A}),(t,s)=>(R(),_("div",{ref_key:"anchorRef",ref:p,class:k(v(y))},[t.marker?(R(),_("div",{key:0,ref_key:"markerRef",ref:f,class:k(v(r).e("marker")),style:ae(v(ne))},null,6)):K("v-if",!0),Q("div",{class:k(v(r).e("list"))},[E(t.$slots,"default")],2)],2))}});var _e=X(Re,[["__file","anchor.vue"]]);const Le=N({title:String,href:String}),Te=L({name:"ElAnchorLink"}),$e=L({...Te,props:Le,setup(e){const n=e,l=g(null),{ns:o,direction:u,currentAnchor:p,addLink:f,removeLink:a,handleClick:d}=se(W),h=B(()=>[o.e("link"),o.is("active",p.value===n.href)]),b=r=>{d(r,n.href)};return q(()=>n.href,(r,y)=>{ve(()=>{y&&a(y),r&&f({href:r,el:l.value})})}),P(()=>{const{href:r}=n;r&&f({href:r,el:l.value})}),ie(()=>{const{href:r}=n;r&&a(r)}),(r,y)=>(R(),_("div",{class:k(v(o).e("item"))},[Q("a",{ref_key:"linkRef",ref:l,class:k(v(h)),href:r.href,onClick:b},[E(r.$slots,"default",{},()=>[ce(ue(r.title),1)])],10,["href"]),r.$slots["sub-link"]&&v(u)==="vertical"?(R(),_("div",{key:0,class:k(v(o).e("list"))},[E(r.$slots,"sub-link")],2)):K("v-if",!0)],2))}});var Z=X($e,[["__file","anchor-link.vue"]]);const Se=fe(_e,{AnchorLink:Z}),Be=de(Z);export{Be as B,Se as L};
