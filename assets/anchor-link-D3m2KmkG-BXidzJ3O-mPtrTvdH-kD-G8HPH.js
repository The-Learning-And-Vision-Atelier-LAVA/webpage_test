import{F as M,a5 as A,Y as S,m as g,T as oe,R as x,an as re,n as X,_ as Y,r as le,a as $,C,$ as k,w as v,I as ae,e as q,o as z,f as j,j as U,S as se,q as ie,P as ce,u as ue,i as fe,L as de,A as E,N as Q,aF as he,bl as T,ae as ve,aP as pe}from"./index-BrdBUvI4.js";import{m as B,i as V}from"./raf-CNtY2p3o-DrbpYkfE-jmlIg56D-BSA2i53l.js";function me(e,n,l,o){const u=l-n;return e/=o/2,e<1?u/2*e*e*e+n:u/2*((e-=2)*e*e+2)+n}function ke(e,n,l,o,u){const p=Date.now();let f;const a=()=>{const d=Date.now()-p,h=me(d>o?o:d,n,l,o);T(e)?e.scrollTo(window.pageXOffset,h):e.scrollTop=h,d<o?f=V(a):pe(u)&&u()};return a(),()=>{f&&B(f)}}const N=(e,n)=>T(n)?e.ownerDocument.documentElement:n,O=e=>T(e)?window.scrollY:e.scrollTop,P=e=>{let n=0,l=e;for(;l;)n+=l.offsetTop,l=l.offsetParent;return n},H=(e,n)=>Math.abs(P(e)-P(n)),ye=M({container:{type:A([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:A(String),default:"default"},direction:{type:A(String),default:"vertical"}}),ge={change:e=>E(e),click:(e,n)=>e instanceof MouseEvent&&(E(n)||Q(n))},Z=Symbol("anchor"),b=e=>{if(!he||e==="")return null;if(E(e))try{return document.querySelector(e)}catch{return null}return e};function we(e){let n=0;const l=(...o)=>{n&&B(n),n=V(()=>{e(...o),n=0})};return l.cancel=()=>{B(n),n=0},l}const be=S({name:"ElAnchor"}),$e=S({...be,props:ye,emits:ge,setup(e,{expose:n,emit:l}){const o=e,u=g(""),p=g(null),f=g(null),a=g(),d={};let h=!1,w=0;const r=oe("anchor"),y=x(()=>[r.b(),o.type==="underline"?r.m("underline"):"",r.m(o.direction)]),J=t=>{d[t.href]=t.el},K=t=>{delete d[t]},D=t=>{u.value!==t&&(u.value=t,l("change",t))};let _=null;const W=t=>{if(!a.value)return;const s=b(t);if(!s)return;_&&_(),h=!0;const i=N(s,a.value),c=H(s,i),m=i.scrollHeight-i.clientHeight,R=Math.min(c-o.offset,m);_=ke(a.value,w,R,o.duration,()=>{setTimeout(()=>{h=!1},20)})},L=t=>{t&&(D(t),W(t))},ee=(t,s)=>{l("click",t,s),L(s)},F=we(()=>{a.value&&(w=O(a.value));const t=te();h||Q(t)||D(t)}),te=()=>{if(!a.value)return;const t=O(a.value),s=[];for(const i of Object.keys(d)){const c=b(i);if(!c)continue;const m=N(c,a.value),R=H(c,m);s.push({top:R-o.offset-o.bound,href:i})}s.sort((i,c)=>i.top-c.top);for(let i=0;i<s.length;i++){const c=s[i],m=s[i+1];if(i===0&&t===0)return"";if(c.top<=t&&(!m||m.top>t))return c.href}},I=()=>{const t=b(o.container);!t||T(t)?a.value=window:a.value=t};re(a,"scroll",F);const ne=x(()=>{if(!p.value||!f.value||!u.value)return{};const t=d[u.value];if(!t)return{};const s=p.value.getBoundingClientRect(),i=f.value.getBoundingClientRect(),c=t.getBoundingClientRect();return o.direction==="horizontal"?{left:`${c.left-s.left}px`,width:`${c.width}px`,opacity:1}:{top:`${c.top-s.top+(c.height-i.height)/2}px`,opacity:1}});return X(()=>{I();const t=decodeURIComponent(window.location.hash);b(t)?L(t):F()}),Y(()=>o.container,()=>{I()}),le(Z,{ns:r,direction:o.direction,currentAnchor:u,addLink:J,removeLink:K,handleClick:ee}),n({scrollTo:L}),(t,s)=>($(),C("div",{ref_key:"anchorRef",ref:p,class:k(v(y))},[t.marker?($(),C("div",{key:0,ref_key:"markerRef",ref:f,class:k(v(r).e("marker")),style:ae(v(ne))},null,6)):q("v-if",!0),z("div",{class:k(v(r).e("list"))},[j(t.$slots,"default")],2)],2))}});var Ce=U($e,[["__file","anchor.vue"]]);const Se=M({title:String,href:String}),Te=S({name:"ElAnchorLink"}),_e=S({...Te,props:Se,setup(e){const n=e,l=g(null),{ns:o,direction:u,currentAnchor:p,addLink:f,removeLink:a,handleClick:d}=se(Z),h=x(()=>[o.e("link"),o.is("active",p.value===n.href)]),w=r=>{d(r,n.href)};return Y(()=>n.href,(r,y)=>{ve(()=>{y&&a(y),r&&f({href:r,el:l.value})})}),X(()=>{const{href:r}=n;r&&f({href:r,el:l.value})}),ie(()=>{const{href:r}=n;r&&a(r)}),(r,y)=>($(),C("div",{class:k(v(o).e("item"))},[z("a",{ref_key:"linkRef",ref:l,class:k(v(h)),href:r.href,onClick:w},[j(r.$slots,"default",{},()=>[ce(ue(r.title),1)])],10,["href"]),r.$slots["sub-link"]&&v(u)==="vertical"?($(),C("div",{key:0,class:k(v(o).e("list"))},[j(r.$slots,"sub-link")],2)):q("v-if",!0)],2))}});var G=U(_e,[["__file","anchor-link.vue"]]);const Ae=fe(Ce,{AnchorLink:G}),xe=de(G);export{Ae as A,xe as x};
