import{N as M,a5 as A,J as R,n as g,R as oe,j as x,an as re,r as V,w as z,y as ae,a as $,k as _,F as k,_ as p,L as le,d as J,o as K,e as B,h as W,A as se,x as ie,W as ce,V as ue,i as fe,P as de,K as N,T as q,aF as he,bl as S,ae as pe,aP as ve}from"./index-DEiH0o32.js";import{m as P,a as G}from"./raf-CNtY2p3o-DrbpYkfE-jmlIg56D.js";function me(e,n,a,o){const u=a-n;return e/=o/2,e<1?u/2*e*e*e+n:u/2*((e-=2)*e*e+2)+n}function ke(e,n,a,o,u){const v=Date.now();let f;const l=()=>{const d=Date.now()-v,h=me(d>o?o:d,n,a,o);S(e)?e.scrollTo(window.pageXOffset,h):e.scrollTop=h,d<o?f=G(l):ve(u)&&u()};return l(),()=>{f&&P(f)}}const F=(e,n)=>S(n)?e.ownerDocument.documentElement:n,H=e=>S(e)?window.scrollY:e.scrollTop,O=e=>{let n=0,a=e;for(;a;)n+=a.offsetTop,a=a.offsetParent;return n},I=(e,n)=>Math.abs(O(e)-O(n)),ye=M({container:{type:A([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:A(String),default:"default"},direction:{type:A(String),default:"vertical"}}),ge={change:e=>N(e),click:(e,n)=>e instanceof MouseEvent&&(N(n)||q(n))},U=Symbol("anchor"),w=e=>{if(!he||e==="")return null;if(N(e))try{return document.querySelector(e)}catch{return null}return e};function be(e){let n=0;const a=(...o)=>{n&&P(n),n=G(()=>{e(...o),n=0})};return a.cancel=()=>{P(n),n=0},a}const we=R({name:"ElAnchor"}),$e=R({...we,props:ye,emits:ge,setup(e,{expose:n,emit:a}){const o=e,u=g(""),v=g(null),f=g(null),l=g(),d={};let h=!1,b=0;const r=oe("anchor"),y=x(()=>[r.b(),o.type==="underline"?r.m("underline"):"",r.m(o.direction)]),Y=t=>{d[t.href]=t.el},Z=t=>{delete d[t]},j=t=>{u.value!==t&&(u.value=t,a("change",t))};let C=null;const Q=t=>{if(!l.value)return;const s=w(t);if(!s)return;C&&C(),h=!0;const i=F(s,l.value),c=I(s,i),m=i.scrollHeight-i.clientHeight,T=Math.min(c-o.offset,m);C=ke(l.value,b,T,o.duration,()=>{setTimeout(()=>{h=!1},20)})},L=t=>{t&&(j(t),Q(t))},ee=(t,s)=>{a("click",t,s),L(s)},D=be(()=>{l.value&&(b=H(l.value));const t=te();h||q(t)||j(t)}),te=()=>{if(!l.value)return;const t=H(l.value),s=[];for(const i of Object.keys(d)){const c=w(i);if(!c)continue;const m=F(c,l.value),T=I(c,m);s.push({top:T-o.offset-o.bound,href:i})}s.sort((i,c)=>i.top-c.top);for(let i=0;i<s.length;i++){const c=s[i],m=s[i+1];if(i===0&&t===0)return"";if(c.top<=t&&(!m||m.top>t))return c.href}},E=()=>{const t=w(o.container);!t||S(t)?l.value=window:l.value=t};re(l,"scroll",D);const ne=x(()=>{if(!v.value||!f.value||!u.value)return{};const t=d[u.value];if(!t)return{};const s=v.value.getBoundingClientRect(),i=f.value.getBoundingClientRect(),c=t.getBoundingClientRect();return o.direction==="horizontal"?{left:`${c.left-s.left}px`,width:`${c.width}px`,opacity:1}:{top:`${c.top-s.top+(c.height-i.height)/2}px`,opacity:1}});return V(()=>{E();const t=decodeURIComponent(window.location.hash);w(t)?L(t):D()}),z(()=>o.container,()=>{E()}),ae(U,{ns:r,direction:o.direction,currentAnchor:u,addLink:Y,removeLink:Z,handleClick:ee}),n({scrollTo:L}),(t,s)=>($(),_("div",{ref_key:"anchorRef",ref:v,class:k(p(y))},[t.marker?($(),_("div",{key:0,ref_key:"markerRef",ref:f,class:k(p(r).e("marker")),style:le(p(ne))},null,6)):J("v-if",!0),K("div",{class:k(p(r).e("list"))},[B(t.$slots,"default")],2)],2))}});var _e=W($e,[["__file","anchor.vue"]]);const Re=M({title:String,href:String}),Se=R({name:"ElAnchorLink"}),Ce=R({...Se,props:Re,setup(e){const n=e,a=g(null),{ns:o,direction:u,currentAnchor:v,addLink:f,removeLink:l,handleClick:d}=se(U),h=x(()=>[o.e("link"),o.is("active",v.value===n.href)]),b=r=>{d(r,n.href)};return z(()=>n.href,(r,y)=>{pe(()=>{y&&l(y),r&&f({href:r,el:a.value})})}),V(()=>{const{href:r}=n;r&&f({href:r,el:a.value})}),ie(()=>{const{href:r}=n;r&&l(r)}),(r,y)=>($(),_("div",{class:k(p(o).e("item"))},[K("a",{ref_key:"linkRef",ref:a,class:k(p(h)),href:r.href,onClick:b},[B(r.$slots,"default",{},()=>[ce(ue(r.title),1)])],10,["href"]),r.$slots["sub-link"]&&p(u)==="vertical"?($(),_("div",{key:0,class:k(p(o).e("list"))},[B(r.$slots,"sub-link")],2)):J("v-if",!0)],2))}});var X=W(Ce,[["__file","anchor-link.vue"]]);const Ae=fe(_e,{AnchorLink:X}),xe=de(X);export{xe as B,Ae as S};
